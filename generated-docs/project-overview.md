Last updated: 2025-12-02

# Project Overview

## プロジェクト概要
- Tone.jsの音色・エフェクト・演奏をJSONで記述できる軽量ライブラリ
- コードを書かず、音をデータで制御できるため、UIやストリーミングと自然に連携
- 時間順のイベントをデータとして扱い、緻密な演奏表現が可能に

## 技術スタック
- フロントエンド:
    - **HTML**: ウェブページの構造とコンテンツを記述するために使用されます。デモページの骨格を形成しています。
    - **CSS**: ウェブページのスタイル（デザイン、レイアウト）を定義するために使用されます。デモページの見た目を整えます。
    - **JavaScript**: ウェブページ上での動的な挙動（UI操作、音楽再生ロジック、イベント処理など）を実現するための主要なプログラミング言語です。
- 音楽・オーディオ:
    - **Tone.js**: ブラウザ上で高度な音楽表現を実現するためのJavaScriptライブラリです。シンセサイザーの構築、エフェクトチェーンの適用、音源のトリガーとスケジューリングなど、音楽の中核機能を担います。
    - **Web Audio API**: ブラウザが提供する、ウェブ上での音声処理と合成を可能にするAPIです。Tone.jsの基盤技術として使用されています。
    - **JSON**: 音色定義、演奏内容、タイミング情報などの音楽イベントを記述するためのデータフォーマットとして広く使用されています。このプロジェクトでは、音楽をデータドリブンで制御するためにJSONを多用します。
- 開発ツール:
    - **GitHub Actions**: リポジトリのイベント（プッシュ、プルリクエストなど）をトリガーとして、自動的にタスク（例: READMEの自動英訳）を実行するCI/CD（継続的インテグレーション/継続的デリバリー）ツールです。
    - **EditorConfig**: 異なるエディタやIDE間で一貫したコーディングスタイルを維持するための設定ファイルです。
    - **Markdown**: プロジェクトの説明やドキュメント（`README.ja.md`、`README.md`、`issue-notes`）を記述するための軽量マークアップ言語です。
- テスト:
    - このプロジェクトでは、明示的な自動テストフレームワークの採用は現状なく、手動での動作確認や目視による検証が中心となる方針です。
- ビルドツール:
    - 特に明示的なビルドツール（Webpack, Gulpなど）は使用されておらず、JavaScriptファイルは直接ブラウザで読み込まれるか、シンプルなスクリプト結合によって処理されます。
- 言語機能:
    - **JavaScript**: 主要なプログラミング言語として、アプリケーションロジックの実装に用いられます。
    - **HTML**: ウェブコンテンツの構造定義に用いられます。
    - **CSS**: ウェブコンテンツの視覚的なスタイリング定義に用いられます。
- 自動化・CI/CD:
    - **GitHub Actions**: `README.ja.md`から`README.md`（英語）を自動生成するなど、特定の開発タスクの自動化に利用されています。
- 開発標準:
    - **EditorConfig**: コードのインデントスタイルや文字コードなどのフォーマットを統一し、開発者間のコード品質の一貫性を保つために利用されます。

## ファイル階層ツリー
```
📄 .editorconfig
📄 LICENSE
📖 README.ja.md
📖 README.md
📄 _config.yml
📁 generated-docs/
  🌐 callgraph.html
🌐 googled947dc864c270e07.html
🌐 index.html
📁 issue-notes/
  📖 1.md
  📖 2.md
  📖 3.md
  📖 4.md
📁 src/
  🌐 index.html
  📜 main.js
  📜 play.js
  🎨 redirect.css
  📜 sampleData.js
  📜 scheduleOrExecuteEvent.js
  🎨 styles.css
```

## ファイル詳細説明
- **`.editorconfig`**: コーディングスタイル（インデント、文字コードなど）を定義し、プロジェクト全体で一貫したコードフォーマットを維持するための設定ファイルです。
- **`LICENSE`**: このプロジェクトのソフトウェアライセンスに関する情報が記載されています。
- **`README.ja.md`**: プロジェクトの目的、機能、使い方、技術的な詳細、開発の背景などを日本語で説明する主要なドキュメントです。
- **`README.md`**: `README.ja.md`を基に自動生成された、プロジェクトの英語での説明ドキュメントです。
- **`_config.yml`**: GitHub Pagesのサイト設定（Jekyllのコンフィギュレーション）を定義するファイルです。
- **`generated-docs/callgraph.html`**: プロジェクト内の関数呼び出し関係を視覚的に表示するグラフが埋め込まれたHTMLファイルです。コードの構造理解に役立ちます。
- **`googled947dc864c270e07.html`**: Google Search Consoleなどのサービスがサイト所有権を確認するために使用するファイルです。
- **`index.html`**: プロジェクトのトップページ、または他のデモページへのリダイレクトを提供するHTMLファイルです。
- **`issue-notes/*.md`**: 開発中の課題、検討事項、メモなどを記録したMarkdown形式のドキュメントです。開発の経緯や懸念事項がまとめられています。
- **`src/index.html`**: 実際にTone.jsを用いた音楽再生デモを実行するためのメインHTMLページです。ユーザーインターフェース（シーケンスの選択、再生ボタンなど）と、関連するJavaScriptファイルを読み込みます。
- **`src/main.js`**: デモページのUI（ユーザーインターフェース）に関するJavaScriptロジックを管理します。具体的には、サンプルシーケンスデータの読み込み、セレクタへの表示、選択されたシーケンスをテキストエリアに反映させる機能などを担当します。
- **`src/play.js`**: 音楽の再生と停止を制御するJavaScriptファイルです。Web Audio APIのAudioContextの初期化、JSONで記述されたシーケンスデータの解析、そして`scheduleOrExecuteEvent`関数を呼び出してTone.jsのイベントをスケジュールする役割を担います。
- **`src/redirect.css`**: 特定のHTMLリダイレクトページで使用される、独自のスタイル定義を持つCSSファイルです。
- **`src/sampleData.js`**: Tone.jsの再生デモで使用される、あらかじめ用意された音楽シーケンスのサンプルデータ（JSON形式）を格納しているJavaScriptファイルです。
- **`src/scheduleOrExecuteEvent.js`**: このプロジェクトのコアロジックを担うJavaScriptファイルです。JSON形式のイベントオブジェクトを受け取り、その内容（シンセのトリガー、パラメータ変更、エフェクト設定など）に応じて、対応するTone.jsのメソッドを呼び出し、音楽イベントをスケジュールまたは即時実行します。
- **`src/styles.css`**: デモページ全体の視覚的なデザイン（フォント、色、レイアウトなど）を定義する主要なスタイルシートです。

## 関数詳細説明
- **`initializeSequenceDataCollection()`** (src/main.js):
    - 役割: デモページに表示するサンプルシーケンスデータを初期化し、それらをUIの選択ボックス（セレクタ）にロードするための準備を行います。
    - 引数: なし。
    - 戻り値: なし。
- **`populateSequenceSelector()`** (src/main.js):
    - 役割: 利用可能なサンプルシーケンスのリストを、HTML上のドロップダウンセレクタに動的に追加・表示します。
    - 引数: なし。
    - 戻り値: なし。
- **`updateTextareaWithSelectedSequence()`** (src/main.js):
    - 役割: ユーザーがドロップダウンセレクタでシーケンスを選択した際に、そのシーケンスのJSONデータをテキストエリアに表示内容を更新します。
    - 引数: なし。
    - 戻り値: なし。
- **`playWithAudioContext()`** (src/play.js):
    - 役割: Web Audio APIのAudioContext（音声処理の基盤）を初期化し、Tone.jsが音を再生できる状態を準備します。ブラウザのセキュリティ制約（ユーザーインタラクションがないと音声再生が開始できないなど）に対応します。
    - 引数: なし。
    - 戻り値: なし。
- **`play()`** (src/play.js):
    - 役割: 音楽シーケンスの再生を開始または停止します。指定されたJSON形式のシーケンスデータを受け取り、それを解析して個々の音楽イベントを`scheduleOrExecuteEvent`関数に渡してスケジュールさせます。
    - 引数: `sequenceJson` (再生する音楽イベントを記述したJSON文字列)。
    - 戻り値: なし。
- **`if`** (src/play.js, src/scheduleOrExecuteEvent.js):
    - 役割: 特定の条件が真である場合にのみ、それに続くコードブロックを実行するための条件分岐ロジックです。
    - 引数: 条件式。
    - 戻り値: なし。
- **`catch`** (src/play.js):
    - 役割: `try`ブロック内で発生したエラー（例外）を捕捉し、エラーメッセージの表示や、エラーからの回復処理など、適切なエラーハンドリングを行うために使用されます。
    - 引数: `error` (発生したエラーオブジェクト)。
    - 戻り値: なし。
- **`scheduleOrExecuteEvent()`** (src/scheduleOrExecuteEvent.js):
    - 役割: JSON形式で定義された単一の音楽イベントオブジェクトを受け取り、そのイベントタイプ（例: シンセのトリガー、エフェクトのパラメータ変更）に基づいて適切なTone.jsのメソッドを呼び出し、音響イベントをスケジュールまたは即時実行します。
    - 引数: `event` (JSON形式の音楽イベントオブジェクト)。
    - 戻り値: なし。
- **`switch`** (src/scheduleOrExecuteEvent.js):
    - 役割: `scheduleOrExecuteEvent`関数内で、入力されたイベントオブジェクトの`type`プロパティ（例: "synth", "chain", "param", "trigger"）の値に応じて、異なる処理パスへ分岐するための制御構造です。
    - 引数: `event.type` (イベントの種類を示す文字列)。
    - 戻り値: なし。

## 関数呼び出し階層ツリー
```
- if (src/play.js)
  - playWithAudioContext ()
    - play ()
      - scheduleOrExecuteEvent ()
- catch (src/play.js)
- switch (src/scheduleOrExecuteEvent.js)

---
Generated at: 2025-12-02 07:08:07 JST
